{% extends 'base.html' %}

{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="header">
                    <select id="graficoChart" class="form-control select-title" name="grafico">
                        <option value="0">Todos</option>
                    </select>
                    <p class="category"></p>
                </div>
                <div class="content">
                    <form action="" method="POST">
                        <div class="row">
                            <div class="col-md-4 form-group">
                                <label for="segmentoChart">Segmento</label>
                                <select class="form-control" name="segmento" id="segmentoChart">
                                    <option value="0" selected>Todos</option>
                                </select>
                            </div>
                            <div class="col-md-4 form-group">
                                <label for="campusChart">Campus</label>
                                <select class="form-control" name="campus" id="campusChart">
                                    <option value="0">Todos</option>
                                </select>
                            </div>
                            <div style="display: none;" id="cursoList" class="col-md-4 form-group">
                                {#                            <div id="cursoList" class="col-md-4 form-group">#}
                                <label for="cursoChart">Curso</label>
                                <select disabled class="form-control" name="curso" id="cursoChart">
                                    <option value="0" selected>Todos</option>
                                </select>
                            </div>

                            <div style="display: none;" id="atuacaoList" class="col-md-4 form-group">
                                {#                            <div id="atuacaoList" class="col-md-4 form-group">#}
                                <label for="atuacaoChart">Atuação</label>
                                <select disabled class="form-control" name="atuacao" id="atuacaoChart">
                                    <option value="0" selected>Todos</option>
                                </select>
                            </div>
                            <div style="display: none;" id="lotacaoList" class="col-md-4 form-group">
                                {#                            <div id="lotacaoList" class="col-md-4 form-group">#}
                                <label for="lotacaoChart">Lotação</label>
                                <select disabled class="form-control" name="lotacao" id="lotacaoChart">
                                    <option value="0" selected>Todos</option>
                                </select>
                            </div>

                        </div>
                        <div class="form-group">
                            <label class="switch">
                                <input id="chart-visualization" type="checkbox" onchange="changeVis();" value="true">
                                <span class="slider round"></span>
                            </label>
                            <span class="small text-muted" id="chart-vis-label">Dados Reais</span>
                        </div>
                    </form>
                    <div id="chart-place">

                        <div id="graph" class="ct-chart tc-chart ct-perfect-fourth"></div>
                    </div>

                    <hr>
                    <table id="tableChart" class="table table-hover table-striped">

                    </table>
                    <hr>
                    <div class="footer">
                        <div class="stats">
                            <i class="fa fa-clock-o"></i> Dados relacionadas à 2018.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var filterChart = null;

        function changeVis($event) {
            filterChart.updateChart($('#chart-visualization').prop('checked'))
            $('#chart-visualization').prop('checked') ? $("#chart-vis-label").text("Dados Relativos") :  $("#chart-vis-label").text("Dados Reais")
        }

        window.onload = function () {

            filterChart = new FilterChart();
            $("#segmentoChart").on("change", () => {
                filterChart.loadCampus();
                filterChart.updateChart($('#chart-visualization').prop('checked'));
                let segmento = $("#segmentoChart option:selected").text()
                if (segmento === 'Todos') {
                    $("#cursoList").hide()
                    $("#atuacaoList").hide()
                    $("#lotacaoList").hide()
                    $("#cursoChart").val(0)
                    $("#atuacaoChart").val(0)
                    $("#lotacaoChart").val(0)
                } else if (segmento === 'Estudante') {
                    $("#cursoList").show()
                    $("#atuacaoList").hide()
                    $("#lotacaoList").hide()
                    $("#atuacaoChart").val(0)
                    $("#lotacaoChart").val(0)
                } else if (segmento === 'Docente') {
                    $("#cursoList").hide()
                    $("#atuacaoList").show()
                    $("#lotacaoList").hide()
                    $("#cursoChart").val(0)
                    $("#lotacaoChart").val(0)
                } else if (segmento === 'Técnico Administrativo Câmpus') {
                    $("#cursoList").hide()
                    $("#atuacaoList").hide()
                    $("#lotacaoList").show()
                    $("#cursoChart").val(0)
                    $("#atuacaoChart").val(0)
                } else if (segmento === 'Técnico Administrativo Reitoria') {
                    $("#cursoList").hide()
                    $("#atuacaoList").hide()
                    $("#lotacaoList").show()
                    $("#cursoChart").val(0)
                    $("#atuacaoChart").val(0)
                }
            })
            $("#atuacaoChart").on("change", () => {
                filterChart.updateChart($('#chart-visualization').prop('checked'));
            })
            $("#lotacaoChart").on("change", () => {
                filterChart.updateChart($('#chart-visualization').prop('checked'));
            })
            $("#graficoChart").on("change", () => {
                filterChart.loadSegmentos();
                filterChart.recreateChart($('#chart-visualization').prop('checked'));
            })
            $("#campusChart").on("change", () => {
                filterChart.loadCursos();
                filterChart.loadLotacao();
                filterChart.loadAtuacao();
                filterChart.updateChart($('#chart-visualization').prop('checked'));
            })
            $("#cursoChart").on("change", () => {
                filterChart.updateChart($('#chart-visualization').prop('checked'));
            })

        }
    </script>
{% endblock %}